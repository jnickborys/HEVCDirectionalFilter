//
//
//
#include <math.h>
#include <assert.h>
#include <string.h>
#include <stdlib.h>

#include "global.h"
#include "elements.h"
#include "defines.h"
#include "fmo.h"
#include "vlc.h"
#include "mbuffer.h"
#include "header.h"
#include "adaptive_filter.h"

#ifdef SWITCHED_FILTERS
#include "switched_filters.h"
#endif

#ifdef SWITCHED_FILTERS

extern double STANDARD_2D_FILTER[15][SQR_FILTER];

//
//
//
#ifdef HPF_COMBO
double LCDIF[15][SQR_FILTER] = {
{
   0.0/128.0,   0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0, 0.0/128.0,  
   0.0/128.0,   0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0, 0.0/128.0,  
   3.0/128.0, -15.0/128.0, 111.0/128.0, 37.0/128.0, -10.0/128.0, 2.0/128.0, 
   0.0/128.0,   0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0, 0.0/128.0,  
   0.0/128.0,   0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0, 0.0/128.0,  
   0.0/128.0,   0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0, 0.0/128.0
},  // a_pos
{
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,   0.0/128.0, 0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,   0.0/128.0, 0.0/128.0,  
  3.0/128.0, -17.0/128.0, 78.0/128.0, 78.0/128.0, -17.0/128.0, 3.0/128.0, 
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,   0.0/128.0, 0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,   0.0/128.0, 0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,   0.0/128.0, 0.0/128.0
},  // b_pos
{
  0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,   0.0/128.0, 0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,   0.0/128.0, 0.0/128.0,  
  2.0/128.0, -10.0/128.0, 37.0/128.0, 111.0/128.0, -15.0/128.0, 3.0/128.0, 
  0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,   0.0/128.0, 0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,   0.0/128.0, 0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,   0.0/128.0, 0.0/128.0
},  // c_pos
{
  0.0/128.0, 0.0/128.0,  -3.0/128.0, 0.0/128.0, 0.0/128.0, 0.0/128.0,  
  0.0/128.0, 0.0/128.0, -15.0/128.0, 0.0/128.0, 0.0/128.0, 0.0/128.0,  
  0.0/128.0, 0.0/128.0, 111.0/128.0, 0.0/128.0, 0.0/128.0, 0.0/128.0,  
  0.0/128.0, 0.0/128.0,  37.0/128.0, 0.0/128.0, 0.0/128.0, 0.0/128.0,  
  0.0/128.0, 0.0/128.0, -10.0/128.0, 0.0/128.0, 0.0/128.0, 0.0/128.0,  
  0.0/128.0, 0.0/128.0,   2.0/128.0, 0.0/128.0, 0.0/128.0, 0.0/128.0
},  // d_pos
{
  3.0/128.0,   0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0, 0.0/128.0,  
  0.0/128.0, -15.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0, 0.0/128.0,  
  0.0/128.0,   0.0/128.0, 111.0/128.0,  0.0/128.0,   0.0/128.0, 0.0/128.0,  
  0.0/128.0,   0.0/128.0,   0.0/128.0, 37.0/128.0,   0.0/128.0, 0.0/128.0,  
  0.0/128.0,   0.0/128.0,   0.0/128.0,  0.0/128.0, -10.0/128.0, 0.0/128.0,  
  0.0/128.0,   0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0, 2.0/128.0
},  // e_pos
{
  3.0/256.0,   0.0/256.0,   0.0/256.0,   0.0/256.0,   0.0/256.0, 3.0/256.0,  
  0.0/256.0, -15.0/256.0,   0.0/256.0,   0.0/256.0, -15.0/256.0, 0.0/256.0,  
  0.0/256.0,   0.0/256.0, 111.0/256.0, 111.0/256.0,   0.0/256.0, 0.0/256.0,  
  0.0/256.0,   0.0/256.0,  37.0/256.0,  37.0/256.0,   0.0/256.0, 0.0/256.0,  
  0.0/256.0, -10.0/256.0,   0.0/256.0,   0.0/256.0, -10.0/256.0, 0.0/256.0,  
  2.0/256.0,   0.0/256.0,   0.0/256.0,   0.0/256.0,   0.0/256.0, 2.0/256.0
},  // f_pos
{
  0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,   0.0/128.0, 3.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0, -15.0/128.0, 0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0, 111.0/128.0,   0.0/128.0, 0.0/128.0,  
  0.0/128.0,   0.0/128.0, 37.0/128.0,   0.0/128.0,   0.0/128.0, 0.0/128.0,  
  0.0/128.0, -10.0/128.0,  0.0/128.0,   0.0/128.0,   0.0/128.0, 0.0/128.0,  
  2.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,   0.0/128.0, 0.0/128.0,  
},  // g_pos
{
  0.0/128.0, 0.0/128.0,   3.0/128.0, 0.0/128.0, 0.0/128.0, 0.0/128.0,  
  0.0/128.0, 0.0/128.0, -17.0/128.0, 0.0/128.0, 0.0/128.0, 0.0/128.0,  
  0.0/128.0, 0.0/128.0,  78.0/128.0, 0.0/128.0, 0.0/128.0, 0.0/128.0,  
  0.0/128.0, 0.0/128.0,  78.0/128.0, 0.0/128.0, 0.0/128.0, 0.0/128.0,  
  0.0/128.0, 0.0/128.0, -17.0/128.0, 0.0/128.0, 0.0/128.0, 0.0/128.0,  
  0.0/128.0, 0.0/128.0,   3.0/128.0, 0.0/128.0, 0.0/128.0, 0.0/128.0
},  // h_pos
{
  3.0/256.0,   0.0/256.0,   0.0/256.0,  0.0/256.0,   0.0/256.0, 2.0/256.0,  
  0.0/256.0, -15.0/256.0,   0.0/256.0,  0.0/256.0, -10.0/256.0, 0.0/256.0,  
  0.0/256.0,   0.0/256.0, 111.0/256.0, 37.0/256.0,   0.0/256.0, 0.0/256.0,  
  0.0/256.0,   0.0/256.0, 111.0/256.0, 37.0/256.0,   0.0/256.0, 0.0/256.0,  
  0.0/256.0, -15.0/256.0,   0.0/256.0,  0.0/256.0, -10.0/256.0, 0.0/256.0,  
  3.0/256.0,   0.0/256.0,   0.0/256.0,  0.0/256.0,   0.0/256.0, 2.0/256.0,  
},  // i_pos
{
  3.0/256.0,   0.0/256.0,  0.0/256.0,  0.0/256.0,   0.0/256.0, 3.0/256.0,  
  0.0/256.0, -17.0/256.0,  0.0/256.0,  0.0/256.0, -17.0/256.0, 0.0/256.0,  
  0.0/256.0,   0.0/256.0, 78.0/256.0, 78.0/256.0,   0.0/256.0, 0.0/256.0,  
  0.0/256.0,   0.0/256.0, 78.0/256.0, 78.0/256.0,   0.0/256.0, 0.0/256.0,  
  0.0/256.0, -17.0/256.0,  0.0/256.0,  0.0/256.0, -17.0/256.0, 0.0/256.0,  
  3.0/256.0,   0.0/256.0,  0.0/256.0,  0.0/256.0,   0.0/256.0, 3.0/256.0,  
},  // j_pos
{
  2.0/256.0,   0.0/256.0,  0.0/256.0,   0.0/256.0,   0.0/256.0, 3.0/256.0,  
  0.0/256.0, -10.0/256.0,  0.0/256.0,   0.0/256.0, -15.0/256.0, 0.0/256.0,  
  0.0/256.0,   0.0/256.0, 37.0/256.0, 111.0/256.0,   0.0/256.0, 0.0/256.0,  
  0.0/256.0,   0.0/256.0, 37.0/256.0, 111.0/256.0,   0.0/256.0, 0.0/256.0,  
  0.0/256.0, -10.0/256.0,  0.0/256.0,   0.0/256.0, -15.0/256.0, 0.0/256.0,  
  2.0/256.0,   0.0/256.0,  0.0/256.0,   0.0/256.0,   0.0/256.0, 3.0/256.0,  
},  // k_pos
{
  0.0/128.0, 0.0/128.0,   2.0/128.0, 0.0/128.0, 0.0/128.0, 0.0/128.0,  
  0.0/128.0, 0.0/128.0, -10.0/128.0, 0.0/128.0, 0.0/128.0, 0.0/128.0,  
  0.0/128.0, 0.0/128.0,  37.0/128.0, 0.0/128.0, 0.0/128.0, 0.0/128.0,  
  0.0/128.0, 0.0/128.0, 111.0/128.0, 0.0/128.0, 0.0/128.0, 0.0/128.0,  
  0.0/128.0, 0.0/128.0, -15.0/128.0, 0.0/128.0, 0.0/128.0, 0.0/128.0,  
  0.0/128.0, 0.0/128.0,   3.0/128.0, 0.0/128.0, 0.0/128.0, 0.0/128.0
},  // l_pos
{
  0.0/128.0,   0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0, 2.0/128.0,  
  0.0/128.0,   0.0/128.0,   0.0/128.0,  0.0/128.0, -10.0/128.0, 0.0/128.0,  
  0.0/128.0,   0.0/128.0,   0.0/128.0, 37.0/128.0,   0.0/128.0, 0.0/128.0,  
  0.0/128.0,   0.0/128.0, 111.0/128.0,  0.0/128.0,   0.0/128.0, 0.0/128.0,  
  0.0/128.0, -15.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0, 0.0/128.0,  
  3.0/128.0,   0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0, 0.0/128.0,  
},  // m_pos
{
  2.0/256.0,   0.0/256.0,   0.0/256.0,   0.0/256.0,   0.0/256.0, 2.0/256.0,  
  0.0/256.0, -10.0/256.0,   0.0/256.0,   0.0/256.0, -10.0/256.0, 0.0/256.0,  
  0.0/256.0,   0.0/256.0,  37.0/256.0,  37.0/256.0,   0.0/256.0, 0.0/256.0,  
  0.0/256.0,   0.0/256.0, 111.0/256.0, 111.0/256.0,   0.0/256.0, 0.0/256.0,  
  0.0/256.0, -15.0/256.0,   0.0/256.0,   0.0/256.0, -15.0/256.0, 0.0/256.0,  
  3.0/256.0,   0.0/256.0,   0.0/256.0,   0.0/256.0,   0.0/256.0, 3.0/256.0,  
},  // n_pos
{
  2.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,   0.0/128.0, 0.0/128.0,  
  0.0/128.0, -10.0/128.0,  0.0/128.0,   0.0/128.0,   0.0/128.0, 0.0/128.0,  
  0.0/128.0,   0.0/128.0, 37.0/128.0,   0.0/128.0,   0.0/128.0, 0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0, 111.0/128.0,   0.0/128.0, 0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0, -15.0/128.0, 0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,   0.0/128.0, 3.0/128.0,  
}  // o_pos
};
#endif

//
//
//
double SYMMETRIC_1[15][SQR_FILTER] = {
{
   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  
   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  
  -1.0/128.0, -2.0/128.0, 97.0/128.0, 42.0/128.0, -11.0/128.0,  3.0/128.0, 
   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  
   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  
   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0
},  // a_pos
{
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  
  3.0/128.0, -16.0/128.0, 77.0/128.0, 77.0/128.0, -16.0/128.0,  3.0/128.0, 
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0
},  // b_pos
{
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  
  3.0/128.0, -11.0/128.0, 42.0/128.0, 97.0/128.0, -2.0/128.0, -1.0/128.0, 
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0
},  // c_pos
{
  0.0/128.0,  0.0/128.0,   -1.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,   -2.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,   97.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,   42.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,  -11.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,    3.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0
},  // d_pos
{
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  -7.0/128.0,  4.0/128.0, -2.0/128.0, -3.0/128.0,  0.0/128.0,  
  0.0/128.0,   4.0/128.0, 66.0/128.0, 36.0/128.0,  1.0/128.0,  0.0/128.0,  
  0.0/128.0,  -2.0/128.0, 36.0/128.0,  7.0/128.0, -6.0/128.0,  0.0/128.0,  
  0.0/128.0,  -3.0/128.0,  1.0/128.0, -6.0/128.0,  2.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0
},  // e_pos
{
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  -4.0/128.0, -1.0/128.0, -1.0/128.0, -4.0/128.0,  0.0/128.0,  
  0.0/128.0,  -2.0/128.0, 56.0/128.0, 56.0/128.0, -2.0/128.0,  0.0/128.0,  
  0.0/128.0,  -7.0/128.0, 25.0/128.0, 25.0/128.0, -7.0/128.0,  0.0/128.0,  
  0.0/128.0,   1.0/128.0, -4.0/128.0, -4.0/128.0,  1.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0
},  // f_pos
{
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  -3.0/128.0, -2.0/128.0,  4.0/128.0, -7.0/128.0,  0.0/128.0,  
  0.0/128.0,   1.0/128.0, 36.0/128.0, 66.0/128.0,  4.0/128.0,  0.0/128.0,  
  0.0/128.0,  -6.0/128.0,  7.0/128.0, 36.0/128.0, -2.0/128.0,  0.0/128.0,  
  0.0/128.0,   2.0/128.0, -6.0/128.0,  1.0/128.0, -3.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0
},  // g_pos
{
  0.0/128.0,  0.0/128.0,    3.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,  -16.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,   77.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,   77.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,  -16.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,    3.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0
},  // h_pos
{
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  -4.0/128.0, -2.0/128.0, -7.0/128.0,  1.0/128.0,  0.0/128.0,  
  0.0/128.0,  -1.0/128.0, 56.0/128.0, 25.0/128.0, -4.0/128.0,  0.0/128.0,  
  0.0/128.0,  -1.0/128.0, 56.0/128.0, 25.0/128.0, -4.0/128.0,  0.0/128.0,  
  0.0/128.0,  -4.0/128.0, -2.0/128.0, -7.0/128.0,  1.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0
},  // i_pos
{
  0.0/128.0,   0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  -6.0/128.0, -6.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  -6.0/128.0,  44.0/128.0, 44.0/128.0, -6.0/128.0,  0.0/128.0,  
  0.0/128.0,  -6.0/128.0,  44.0/128.0, 44.0/128.0, -6.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  -6.0/128.0, -6.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0
},  // j_pos
{
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,   1.0/128.0, -7.0/128.0, -2.0/128.0, -4.0/128.0,  0.0/128.0,  
  0.0/128.0,  -4.0/128.0, 25.0/128.0, 56.0/128.0, -1.0/128.0,  0.0/128.0,  
  0.0/128.0,  -4.0/128.0, 25.0/128.0, 56.0/128.0, -1.0/128.0,  0.0/128.0,  
  0.0/128.0,   1.0/128.0, -7.0/128.0, -2.0/128.0, -4.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0
},  // k_pos
{
  0.0/128.0,  0.0/128.0,    3.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,  -11.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,   42.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,   97.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,   -2.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,   -1.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0
},  // l_pos
{
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  -3.0/128.0,  1.0/128.0, -6.0/128.0,  2.0/128.0,  0.0/128.0,  
  0.0/128.0,  -2.0/128.0, 36.0/128.0,  7.0/128.0, -6.0/128.0,  0.0/128.0,  
  0.0/128.0,   4.0/128.0, 66.0/128.0, 36.0/128.0,  1.0/128.0,  0.0/128.0,  
  0.0/128.0,  -7.0/128.0,  4.0/128.0, -2.0/128.0, -3.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0
},  // m_pos
{
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,   1.0/128.0, -4.0/128.0, -4.0/128.0,  1.0/128.0,  0.0/128.0,  
  0.0/128.0,  -7.0/128.0, 25.0/128.0, 25.0/128.0, -7.0/128.0,  0.0/128.0,  
  0.0/128.0,  -2.0/128.0, 56.0/128.0, 56.0/128.0, -2.0/128.0,  0.0/128.0,  
  0.0/128.0,  -4.0/128.0, -1.0/128.0, -1.0/128.0, -4.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0
},  // n_pos
{
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,   2.0/128.0, -6.0/128.0,  1.0/128.0, -3.0/128.0,  0.0/128.0,  
  0.0/128.0,  -6.0/128.0,  7.0/128.0, 36.0/128.0, -2.0/128.0,  0.0/128.0,  
  0.0/128.0,   1.0/128.0, 36.0/128.0, 66.0/128.0,  4.0/128.0,  0.0/128.0,  
  0.0/128.0,  -3.0/128.0, -2.0/128.0,  4.0/128.0, -7.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0
}  // o_pos
};


//
//
//
double SYMMETRIC_2[15][SQR_FILTER] = {
{
  0.0/128.0,   0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  
  4.0/128.0, -14.0/128.0, 108.0/128.0, 38.0/128.0, -12.0/128.0,  4.0/128.0, 
  0.0/128.0,   0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0
},  // a_pos
{
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  
  6.0/128.0, -23.0/128.0, 81.0/128.0, 81.0/128.0, -23.0/128.0,  6.0/128.0, 
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0
},  // b_pos
{
  0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  
  4.0/128.0, -12.0/128.0, 38.0/128.0, 108.0/128.0, -14.0/128.0, 4.0/128.0, 
  0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0
},  // c_pos
{
  0.0/128.0,  0.0/128.0,    4.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,  -14.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,  108.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,   38.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,  -12.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,    4.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0
},  // d_pos
{
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  -6.0/128.0,  2.0/128.0, -4.0/128.0, -3.0/128.0,  0.0/128.0,  
  0.0/128.0,   2.0/128.0, 71.0/128.0, 38.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  -4.0/128.0, 38.0/128.0,  7.0/128.0, -7.0/128.0,  0.0/128.0,  
  0.0/128.0,  -3.0/128.0,  0.0/128.0, -7.0/128.0,  4.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0
},  // e_pos
{
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  -3.0/128.0, -2.0/128.0, -2.0/128.0, -3.0/128.0,  0.0/128.0,  
  0.0/128.0,  -3.0/128.0, 58.0/128.0, 58.0/128.0, -3.0/128.0,  0.0/128.0,  
  0.0/128.0,  -9.0/128.0, 26.0/128.0, 26.0/128.0, -9.0/128.0,  0.0/128.0,  
  0.0/128.0,   2.0/128.0, -5.0/128.0, -5.0/128.0,  2.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0
},  // f_pos
{
  0.0/128.0,   0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  
  0.0/128.0,  -3.0/128.0,  -4.0/128.0,  2.0/128.0,  -6.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  38.0/128.0, 71.0/128.0,   2.0/128.0,  0.0/128.0,  
  0.0/128.0,  -7.0/128.0,   7.0/128.0, 38.0/128.0,  -4.0/128.0,  0.0/128.0,  
  0.0/128.0,   4.0/128.0,  -7.0/128.0,  0.0/128.0,  -3.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0
},  // g_pos
{
  0.0/128.0,  0.0/128.0,    6.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,  -23.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,   81.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,   81.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,  -23.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,    6.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0
},  // h_pos
{
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  -3.0/128.0, -3.0/128.0, -9.0/128.0,  2.0/128.0,  0.0/128.0,  
  0.0/128.0,  -2.0/128.0, 58.0/128.0, 26.0/128.0, -5.0/128.0,  0.0/128.0,  
  0.0/128.0,  -2.0/128.0, 58.0/128.0, 26.0/128.0, -5.0/128.0,  0.0/128.0,  
  0.0/128.0,  -3.0/128.0, -3.0/128.0, -9.0/128.0,  2.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0
},  // i_pos
{
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,   1.0/128.0, -7.0/128.0, -7.0/128.0,  1.0/128.0,  0.0/128.0,  
  0.0/128.0,  -7.0/128.0, 45.0/128.0, 45.0/128.0, -7.0/128.0,  0.0/128.0,  
  0.0/128.0,  -7.0/128.0, 45.0/128.0, 45.0/128.0, -7.0/128.0,  0.0/128.0,  
  0.0/128.0,   1.0/128.0, -7.0/128.0, -7.0/128.0,  1.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0
},  // j_pos
{
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,   2.0/128.0, -9.0/128.0, -3.0/128.0, -3.0/128.0,  0.0/128.0,  
  0.0/128.0,  -5.0/128.0, 26.0/128.0, 58.0/128.0, -2.0/128.0,  0.0/128.0,  
  0.0/128.0,  -5.0/128.0, 26.0/128.0, 58.0/128.0, -2.0/128.0,  0.0/128.0,  
  0.0/128.0,   2.0/128.0, -9.0/128.0, -3.0/128.0, -3.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0
},  // k_pos
{
  0.0/128.0,  0.0/128.0,    4.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,  -12.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,   38.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,  108.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,  -14.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  0.0/128.0,    4.0/128.0, 0.0/128.0,  0.0/128.0,  0.0/128.0
},  // l_pos
{
  0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  -3.0/128.0,  0.0/128.0,  -7.0/128.0,  4.0/128.0,  0.0/128.0,  
  0.0/128.0,  -4.0/128.0, 38.0/128.0,   7.0/128.0, -7.0/128.0,  0.0/128.0,  
  0.0/128.0,   2.0/128.0, 71.0/128.0,  38.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,  -6.0/128.0,  2.0/128.0,  -4.0/128.0, -3.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0
},  // m_pos
{
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  
  0.0/128.0,   2.0/128.0, -5.0/128.0, -5.0/128.0,  2.0/128.0,  0.0/128.0,  
  0.0/128.0,  -9.0/128.0, 26.0/128.0, 26.0/128.0, -9.0/128.0,  0.0/128.0,  
  0.0/128.0,  -3.0/128.0, 58.0/128.0, 58.0/128.0, -3.0/128.0,  0.0/128.0,  
  0.0/128.0,  -3.0/128.0, -2.0/128.0, -2.0/128.0, -3.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0,  0.0/128.0
},  // n_pos
{
  0.0/128.0,   0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0,  
  0.0/128.0,   4.0/128.0,  -7.0/128.0,  0.0/128.0,  -3.0/128.0,  0.0/128.0,  
  0.0/128.0,  -7.0/128.0,   7.0/128.0, 38.0/128.0,  -4.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,  38.0/128.0, 71.0/128.0,   2.0/128.0,  0.0/128.0,  
  0.0/128.0,  -3.0/128.0,  -4.0/128.0,  2.0/128.0,  -6.0/128.0,  0.0/128.0,  
  0.0/128.0,   0.0/128.0,   0.0/128.0,  0.0/128.0,   0.0/128.0,  0.0/128.0
}  // o_pos
};

#ifdef HPF_COMBO
//
//  Clip a value between low and high
//
int Clip3Fun(int low, int high, int val)
{
  return ((val < low)? low: (val > high)? high: val);
}
#endif

//
//
//
void readSIFOHeader()
{
  Slice *currSlice = img->currentSlice;
  int dP_nr = assignSE2partition[currSlice->dp_mode][SE_HEADER];
  DataPartition *partition = &(currSlice->partArr[dP_nr]);
  Bitstream *currStream = partition->bitstream;

  if(img->type != I_SLICE)
  {
    img->filterParam = u_v(1, "SH: use offsets", currStream); // 1 bit only

    {
      // Read filters with bestFilter option
      int bestFilter;
      int sub_pos;

      memset(img->filter, 0, 16 * sizeof(int));
      bestFilter = u_v (2, "SH: bestFilter", currStream);

      if(bestFilter == 0)
      {
        for(sub_pos = 1; sub_pos < 16; ++sub_pos)
        {
          img->filter[sub_pos] = u_1("SH: filter", currStream);
          if(img->filter[sub_pos] == 1)
            if(u_1("SH: filter", currStream))
              img->filter[sub_pos] = 2;
        }
      }
      else
      {
        for(sub_pos = 1; sub_pos < 16; ++sub_pos)
          img->filter[sub_pos] = bestFilter - 1;
      }
    }

    if(img->filterParam == SIFO_USE_OFFSETS)
    {
      // Read offsets
      int sub_pos, frame, nonzero, list;
      int listNo = (img->type == B_SLICE)? 2: 1;

      for(list = 0; list < listNo; ++list) 
      {    
        memset(img->subpelOffset[list], 0, 16 * sizeof(int));
        memset(img->imgOffset[list], 0, 16 * sizeof(int));

        nonzero = u_1("SH: nonzero offset", currStream);
        if(nonzero)
        {
          for(frame = 0; frame < listXsize[list]; ++frame)
          {       
            if(frame == 0)
            {     
              for(sub_pos = 0; sub_pos < 16; ++sub_pos)          
                img->subpelOffset[list][sub_pos] = se_v("SH: subpelOffset", currStream);
            }
            else
            { 
              img->imgOffset[list][frame] = se_v("SH: imgOffset", currStream);
            }
          }
        }
      }
    }
  }
}



//
//
//
int getblock2DFilt_quarter_pel(int ref_idx, StorablePicture **list, int x_pos, int y_pos,
                               int mvx, int mvy, int img_width, int img_height, 
                               int block[BLOCK_SIZE][BLOCK_SIZE])
{
  int i,j, ii, jj;
  int x4, y4, sub_pos, pos_x, pos_y, x_sub, y_sub;
  int temp; 
  int offset;
  double is;
  double *FILTER = NULL;

#ifndef EDAIF2
  int FILTER_SIZE = 6;
  int FILTER_OFFSET = (FILTER_SIZE) / 2 - 1;
#endif

  if(img->filterParam == SIFO_FILTERS_ONLY) 
  {
    for(i = 0; i < BLOCK_SIZE; ++i) //y
      for(j = 0; j < BLOCK_SIZE; ++j) //x
      {
        x4 = (j + x_pos) * 4 + mvx;
        y4 = (i + y_pos) * 4 + mvy;

        x_sub = (x4 < 0)? (4 - abs(x4) % 4) % 4: x4 % 4;
        y_sub = (y4 < 0)? (4 - abs(y4) % 4) % 4: y4 % 4;
        sub_pos = x_sub + 4 * y_sub;

        if(sub_pos != 0)
        {
          if(img->filter[sub_pos] == 0)
            FILTER = STANDARD_2D_FILTER[sub_pos-1];
          else if(img->filter[sub_pos] == 1)
#ifdef HPF_COMBO
            FILTER = LCDIF[sub_pos-1];
#else
            FILTER = SYMMETRIC_1[sub_pos-1];
#endif
          else if (img->filter[sub_pos] == 2)
            FILTER = SYMMETRIC_2[sub_pos-1];
          else
            error("img->filterSequence should be less than 3", -1);

#ifdef HPF_COMBO
          if((sub_pos == 7)  && (img->filter[sub_pos] == 0))		// g
          {	
            // Strong filter position
            static const int f0[4][4] = {{  0,  5,  5,  0},
                                         {  5, 22, 22,  5},
                                         {  5, 22, 22,  5},
                                         {  0,  5,  5,  0}};
            int sfp = 0;
            int l, k;
            for(l = 0; l < 4; ++l)
            {
              for(k = 0; k < 4; ++k)
              {
                pos_y = Clip3Fun(0, img_height - 1, y4 / 4 - 1 + l);
                if((y4 < 0) && (pos_y > 0))
                  pos_y -= 1;
                pos_x = Clip3Fun(0, img_width - 1, x4 / 4 - 1 + k);
                if((x4 < 0) && (pos_x > 0))
                  pos_x -=1;
                sfp += f0[l][k] * list[ref_idx]->imgY[pos_y][pos_x];
              }
            }
#ifdef  INTERNAL_BIT_DEPTH_INCREASE
            block[j][i] = Clip3Fun(0, (1 << img->bitdepth_luma) - 1, (sfp + 64) >> 7);
#else
            block[j][i] = Clip3Fun(0, 255, (sfp + 64) >> 7);
#endif
          }
          else
          {
#endif  // HPF_COMBO
            is = 0.0;
            for(ii = 0; ii < FILTER_SIZE; ++ii)
              for(jj = 0; jj < FILTER_SIZE; ++jj)
              {
                pos_y = Clip3(0, img_height-1, y4 / 4 - FILTER_OFFSET + ii);
                if((y4 < 0) && (pos_y > 0))
                  pos_y -= 1;
                pos_x = Clip3(0, img_width -1, x4 / 4 - FILTER_OFFSET + jj);
                if((x4 < 0) && (pos_x > 0))
                  pos_x -=1;
                is += (FILTER[FILTER_SIZE * ii + jj] * list[ref_idx]->imgY[pos_y][pos_x]);
              }
#ifdef  INTERNAL_BIT_DEPTH_INCREASE
              block[j][i] = Clip3(0, (1 << img->bitdepth_luma) - 1, (int)(is + 0.5));
#else
              block[j][i] = Clip3(0, 255, (int)(is + 0.5));
#endif
#ifdef HPF_COMBO
          }
#endif  // HPF_COMBO
        }
        else
        {
          block[j][i] = list[ref_idx]->imgY[Clip3(0, img_height - 1, y4 / 4)][Clip3(0, img_width - 1, x4 / 4)];
        }
      }
  }
  else
  {
    for(i = 0; i < BLOCK_SIZE; ++i) //y
      for(j = 0; j < BLOCK_SIZE; ++j) //x
      {
        x4 = (j + x_pos) * 4 + mvx;
        y4 = (i + y_pos) * 4 + mvy;

        x_sub = (x4 < 0)? (4 - abs(x4) % 4) % 4: x4 % 4;
        y_sub = (y4 < 0)? (4 - abs(y4) % 4) % 4: y4 % 4; 
        sub_pos = x_sub + 4 * y_sub;          // pos 1..15 in a 4x4 block

        if(ref_idx == 0)  
        {
          if(listX[LIST_0] == list)
            offset = img->subpelOffset[LIST_0][sub_pos];
          else 
            offset = img->subpelOffset[LIST_1][sub_pos];
        }
        else
        {
          if(list == listX[LIST_0])
          {
            if(listX[LIST_0][ref_idx] == listX[LIST_1][0])
              offset = img->subpelOffset[LIST_1][sub_pos];
            else
              offset = img->imgOffset[LIST_0][ref_idx];
          }
          else 
          {
            if (listX[LIST_1][ref_idx] == listX[LIST_0][0])
              offset = img->subpelOffset[LIST_0][sub_pos];
            else
              offset = img->imgOffset[LIST_1][ref_idx];
          }
        }

        if(sub_pos != 0)
        {
          if(img->filter[sub_pos] == 0)
            FILTER = STANDARD_2D_FILTER[sub_pos-1];
          else if(img->filter[sub_pos] == 1)
#ifdef HPF_COMBO
            FILTER = LCDIF[sub_pos-1];
#else
            FILTER = SYMMETRIC_1[sub_pos-1];
#endif
          else if (img->filter[sub_pos] == 2)
            FILTER = SYMMETRIC_2[sub_pos-1];
          else
            error("img->filterSequence should be less than 3", -1);

#ifdef HPF_COMBO
          if((sub_pos == 7)  && (img->filter[sub_pos] == 0))		// g
          {	
            // Strong filter position
            static const int f0[4][4] = {{  0,  5,  5,  0},
                                         {  5, 22, 22,  5},
                                         {  5, 22, 22,  5},
                                         {  0,  5,  5,  0}};
            int sfp = 0;
            int l, k;
            for(l = 0; l < 4; ++l)
            {
              for(k = 0; k < 4; ++k)
              {
                pos_y = Clip3Fun(0, img_height - 1, y4 / 4 - 1 + l);
                if((y4 < 0) && (pos_y > 0))
                  pos_y -= 1;
                pos_x = Clip3Fun(0, img_width - 1, x4 / 4 - 1 + k);
                if((x4 < 0) && (pos_x > 0))
                  pos_x -=1;
                sfp += f0[l][k] * list[ref_idx]->imgY[pos_y][pos_x];
              }
            }
#ifdef  INTERNAL_BIT_DEPTH_INCREASE
            temp = Clip3Fun(0, (1 << img->bitdepth_luma) - 1, (sfp + 64) >> 7);
#else
            temp = Clip3Fun(0, 255, (sfp + 64) >> 7);
#endif
          }
          else
          {
#endif  // HPF_COMBO
            is = 0.0;
            for(ii = 0; ii < FILTER_SIZE; ++ii)
              for(jj = 0; jj < FILTER_SIZE; ++jj)
              {
                pos_y = Clip3(0, img_height - 1, y4 / 4 - FILTER_OFFSET + ii);
                if((y4 < 0) && (pos_y > 0))
                  pos_y -= 1;
                pos_x = Clip3(0, img_width - 1, x4 / 4 - FILTER_OFFSET + jj);
                if((x4 < 0) && (pos_x > 0))
                  pos_x -= 1;
                is += (FILTER[FILTER_SIZE * ii + jj] * list[ref_idx]->imgY[pos_y][pos_x]);
              }
#ifdef  INTERNAL_BIT_DEPTH_INCREASE
              temp = Clip3(0, (1 << img->bitdepth_luma) - 1,(int)(is+0.5));
#else
              temp = Clip3(0, 255,(int)(is+0.5));
#endif
#ifdef HPF_COMBO
          }
#endif  // HPF_COMBO
        }
        else
        {
          temp = list[ref_idx]->imgY[Clip3(0, img_height - 1, y4 / 4)][Clip3(0, img_width - 1, x4 / 4)];
        }
        temp = (int)(temp + offset);
#ifdef  INTERNAL_BIT_DEPTH_INCREASE
        block[j][i] = Clip3(0, (1 << img->bitdepth_luma) - 1, temp);
#else
        block[j][i] = Clip3(0, 255, temp);
#endif
      }
  }
  return sub_pos;
}


//
//
//
int getblock2DFilt(int ref_idx, StorablePicture **list, int x_pos, int y_pos,
                   int mvx, int mvy, int img_width, int img_height, int block[BLOCK_SIZE][BLOCK_SIZE])
{
 // if(img->mv_res)
 //   error("does not support one_eighth_pel\n", 1);
 // else
    return getblock2DFilt_quarter_pel(ref_idx, list, x_pos, y_pos, mvx, mvy, img_width,img_height, block);
}

#endif

